{
    "appsettingsPath": "",
    "aiKey": "",
    "services": {
        "Catalogue": {
            "comment": "The catalogue service provides stock access and update capabilities. Database access is modelled using a delay.",
            "port": 8001,
            "processors": {
                "GetProduct": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseCall", "DeserializeOneItem" ],
                    "successSize": 3072 
                },
                "GetProducts": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseCall", "DeserializeManyItems" ],
                    "successSize": 76800
                },
                "GetSearchProducts": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseCall", "DeserializeFewItems" ],
                    "successSize": 9216
                },
                "UpdateProduct": {
                    "errorSize": 64,
                    "latency": 0,
                    "steps": [ "DatabaseCall", "DeserializeOneItem" ],
                    "successSize": 64
                }
            },
            "steps": {
                "DatabaseCall": { 
                    "type": "DelayStep",
                    "step": {
                        "time" : 0.03
                    }
                },
                "DeserializeOneItem": { 
                    "type": "LoadStep",
                    "step": {
                        "bytes": 3072,
                        "time": 0.0,
                        "percent": 1,
                        "processors": 1
                    }
                },
                "DeserializeFewItems": { 
                    "type": "LoadStep",
                    "step": {
                        "bytes": 9216,
                        "time": 0.0,
                        "percent": 1,
                        "processors": 1
                    }
                },
                "DeserializeManyItems": { 
                    "type": "LoadStep",
                    "step": {
                        "bytes": 76800,
                        "time": 0.0,
                        "percent": 1,
                        "processors": 1
                    }
                }
            }
        },        
        "Search": {
            "comment": "TODO: Add static memory load for query index. TODO: set uri. The search service provides query to index mapping then performs efficient catalogue queries.",
            "port": 8002,
            "processors": {
                "GetBatch" : {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "LookupIndexes", "BatchQuery" ],
                    "successSize": 76800
                },
                "Query" : {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "LookupIndexes", "SearchQuery" ],
                    "successSize": 9216
                }
            },
            "steps": {
                "LookupIndexes": { 
                    "type": "LoadStep",
                    "step": {
                        "bytes": 16,
                        "time": 0.0001,
                        "percent": 1,
                        "processors": 1
                    }
                },
                "BatchQuery": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "BatchQuery",
                        "cacheKeyUniqueness": 40,
                        "client": "CatalogueClient",
                        "method": "get",
                        "path": "/api/Catalogue/GetProducts",
                        "size" : 16,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "SearchQuery": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "SearchQuery",
                        "cacheKeyUniqueness": 5000,
                        "client": "CatalogueClient",
                        "method": "get",
                        "path": "/api/Catalogue/GetSearchProducts",
                        "size" : 16,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                }
            },
            "clients": {
                "CatalogueClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8001",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }
            },
            "poilicies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        },
        "Accounts": {
            "comment": "The accounts service provides account information. Database access is modelled using a delay.",
            "port": 8003,
            "processors": {
                "GetAccountId": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseRead" ],
                    "successSize": 16 
                },
                "GetPurchases": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "InterpretQuery", "DatabaseRead" ],
                    "successSize": 320000                    
                },
                "GetPaymentInfo": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseRead" ],
                    "successSize": 64                    
                },
                "UpdatePurchases": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "DatabaseWrite" ],
                    "successSize": 16                    
                }
            },
            "steps": {
                "InterpretQuery": {
                    "type": "LoadStep",
                    "step": {
                        "bytes": 128,
                        "time" : 0.005,
                        "percent" : 5,
                        "processors" : 1
                    }
                },
                "DatabaseRead": { 
                    "type": "DelayStep",
                    "step": {
                        "time" : 0.01
                    }
                },
                "DatabaseWrite": { 
                    "type": "DelayStep",
                    "step": {
                        "time" : 0.03
                    }
                }
            }
        },
        "Cart": {
            "comment": "TODO: set uri. The cart service maintains a temporary list of products for a customer to purchase at the end of their session.",
            "port": 8004,
            "processors": {
                "AddItem": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "GetCatalogItem", "ModifyCart" ],
                    "successSize": 64
                },
                "RemoveItem": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "ModifyCart" ],
                    "successSize": 64
                },
                "EmptyCart": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "ModifyCart" ],
                    "successSize": 32
                },
                "GetItems": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "ModifyCart" ],
                    "successSize": 2048
                }
            },
            "steps": {
                "GetCatalogItem": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "GetCatalogItem",
                        "cacheKeyUniqueness": 1000,
                        "client": "CatalogueClient",
                        "method": "get",
                        "path": "/api/Catalogue/GetProduct",
                        "size" : 4,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "ModifyCart": {
                    "type": "LoadStep",
                    "step": {
                        "bytes": 64,
                        "time" : 0.0,
                        "percent" : 1,
                        "processors" : 1
                    }
                }
            },
            "clients": {
                "CatalogueClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8001",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }
            },
            "policies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        },
        "Payments": {
            "comment": "The payments service processes payment with a third-party and notifies other services to fulfil their part in the order. The third-party is modelled using a delay.",
            "port": 8005,
            "processors": {
                "ProcessPayment": {
                    "errorSize": 256,
                    "latency": 0,
                    "steps": [ "GetCartItems", "GetCatalogItems", "GetPaymentInstrument", "AuthorizePayment", "PlaceOrder", "UpdatePurchases", "EmptyCart" ],
                    "successSize": 64
                }
            },
            "steps": {
                "AuthorizePayment": {
                    "type": "DelayStep",
                    "step": {
                        "time": "4.2"
                    }
                },
                "GetCatalogItems": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "GetCatalog",
                        "cacheKeyUniqueness": 10000,
                        "client": "CatalogueClient",
                        "method": "get",
                        "path": "/api/Catalogue/GetSearchProducts",
                        "size" : 4,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "GetCartItems": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "GetCart",
                        "cacheKeyUniqueness": 10000,
                        "client": "CartClient",
                        "method": "get",
                        "path": "/api/Cart/GetItems",
                        "size" : 4,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "GetPaymentInstrument": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "GetPayment",
                        "cacheKeyUniqueness": 1000,
                        "client": "AccountsClient",
                        "method": "get",
                        "path": "/api/Accounts/GetPaymentInfo",
                        "size" : 4,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "EmptyCart": {
                    "client": "CartClient",
                    "method": "post",
                    "path": "/api/Cart/GetItems",
                    "size" : 16,
                    "reuseSockets": true,
                    "trueAsync" : true 
                },
                "PlaceOrder": {
                    "client": "CatalogueClient",
                    "method": "post",
                    "path": "/api/Catalogue/UpdateProduct",
                    "size" : 512,
                    "reuseSockets": true,
                    "trueAsync" : true                    
                },
                "UpdatePurchases": {
                    "client": "AccountsClient",
                    "method": "post",
                    "path": "/api/Accounts/UpdatePurchases",
                    "size" : 64,
                    "reuseSockets": true,
                    "trueAsync" : true
                }
            },
            "clients": {
                "CatalogueClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8001",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                },
                "CartClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8004",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                },
                "AccountsClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8003",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }
            },
            "policies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        },
        "BusinessIntelligence": {
            "comment": "The BusinessIntelligence service allows querying for information on purchases over a given period.",
            "port": 8006,
            "processors": {
                "steps": [ "GetUserDetails", "GetCatalogueItems", "GetCatalogueItems", "GetCatalogueItems", "GetCatalogueItems", "GetCatalogueItems" ]

            },
            "steps": {
                "GetUserDetails": {
                    "type": "RequestStep",
                    "step": {
                        "cacheId": "GetUser",
                        "cacheKeyUniqueness": 20,
                        "client": "AccountsClient",
                        "method": "get",
                        "path": "/api/Accounts/GetPurchases",
                        "size" : 64,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                },
                "GetCatalogueItems": {
                    "type": "RequestStep",
                    "step": {
                        "parallelCount": 12,
                        "parallelError": "Any",
                        "cacheId": "GetCatalogue",
                        "cacheKeyUniqueness": 3000,
                        "client": "CatalogueClient",
                        "method": "get",
                        "path": "/api/Catalogue/GetProducts",
                        "size" : 16,
                        "reuseSockets": true,
                        "trueAsync" : false 
                    }
                }
            },
            "clients": {
                "CatalogueClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8001",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                },
                "AccountsClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8003",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }
            },
            "policies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        },
        "Checkout": {
            "comment": "The Checkout service provides a frontend API for checkout web page interactions.",
            "port": 8007,
            "processors": {

            },
            "steps": {

            },
            "clients": {
                "AccountsClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8003",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                },                
                "SearchClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8002",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }
            },
            "policies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        },
        "Browse": {
            "comment": "The Browse service provides a frontend API for store web page interactions.",
            "port": 8008,
            "processors": {

            },
            "steps": {

            },
            "clients": {
                "CartClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8004",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                },
                "PaymentClient": {
                    "baseAddress": "http://todo-cluster-name.northeurope.cloudapp.azure.com:8005",
                    "policies": [ "30SecondTimeout" ], 
                    "headers": { "Accept": "*/*" }
                }                
            },
            "policies": {
                "30SecondTimeout": {
                    "type": "TimeoutConfig",
                    "policy": {
                        "cancelDelegates" : true,
                        "time" : 30.0
                    }
                }
            }
        }
    }
}